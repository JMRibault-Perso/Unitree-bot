#!/usr/bin/env bash
# RELOCALIZATION TEST - WHEN ROBOT IS ONLINE
# ===========================================

echo ""
echo "╔════════════════════════════════════════════════════════════════╗"
echo "║         SLAM RELOCALIZATION DETECTION TEST                     ║"
echo "║  Test if SLAM can find robot position after moving it          ║"
echo "╚════════════════════════════════════════════════════════════════╝"
echo ""
echo "Prerequisites:"
echo "  ✓ Robot is powered on and connected to WiFi (192.168.86.3)"
echo "  ✓ Robot has 'room' map saved in its internal storage"
echo ""
echo "Step 1: Start the web server (if not already running):"
echo ""
echo "  Terminal 1:"
echo "  $ cd /root/G1/unitree_sdk2"
echo "  $ python3 g1_app/__main__.py"
echo ""
echo "Step 2: Run the relocation test (separate terminal):"
echo ""
echo "  Terminal 2:"
echo "  $ cd /root/G1/unitree_sdk2"
echo "  $ python3 test_relocation_detection.py --map room"
echo ""
echo "Step 3: Follow the test prompts:"
echo ""
echo "  Phase 1 (10s): Test loads 'room' map from robot, monitors baseline position"
echo "  Phase 2: Test stops SLAM service"
echo "  Phase 3: ⏸️  TEST PAUSES - You move the robot manually"
echo "           - Pick up/push robot to different location (0.5-1.0m away)"
echo "           - Rotate it to different heading"
echo "           - Press ENTER when done moving"
echo "  Phase 4 (10s): Test restarts SLAM and checks if relocalization detects new position"
echo ""
echo "Expected Results:"
echo "  ✅ SUCCESS: Position jumps to new location (relocalization found robot)"
echo "  ❌ FAILURE: Position stays the same (relocalization didn't work)"
echo ""
echo "Map name: 'room' (stored on robot)"
echo "Robot IP: 192.168.86.3"
echo "Robot SN: G1_6937"
echo ""
echo "Ready to run test!"
echo ""
